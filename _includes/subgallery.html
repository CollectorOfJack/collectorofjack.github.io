{% if include.id %}
  {% assign gallery = page.[include.id] %}
{% else %}
  {% assign gallery = page.gallery %}
{% endif %}

<div class="gallery masonry-gallery">
  {% for img in gallery %}

  <figure class="gallery-item">

	<header class="gallery-icon">

		<a href="{% picture direct {{ img.image_path }} %}" class="popup"  title="{{ img.image-caption }}" data-caption="{{ img.image-copyright }}">
			{% picture portthumb {{ img.image_path }} --alt {{ img.image-caption }} %}
		</a>
	</header>	
		
   <figcaption class="gallery-caption">
		<div class="entry-summary" id="{{ img.image-caption }}">
				<h3>{{img.image-caption}}</h3>
					<p>{{img.image-copyright}}</p>
		</div>
	</figcaption>
  </figure>

  {% endfor %}
</div>

<script language="javascript" type="text/javascript">
	
	$(document).ready(function ($) {
		$('a.popup').magnificPopup({
			type: 'image',
			gallery: {
			enabled: true,
			navigateByImgClick: true,
			preload: [0, 1] // Will preload 0 - before current, and 1 after the current image
			},
			image: {
			titleSrc: function (item) {
				return item.el.attr('title') + '&nbsp;' + item.el.attr('data-caption');
			}
			}
			// other options
			
		});
		alert('mag');
	});

</script>